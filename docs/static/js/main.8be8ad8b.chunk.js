(this.webpackJsonpprototype=this.webpackJsonpprototype||[]).push([[0],{185:function(e,t,n){e.exports=n(389)},266:function(e,t,n){},354:function(e,t,n){},355:function(e,t,n){},382:function(e,t,n){},385:function(e,t,n){},386:function(e,t,n){},387:function(e,t,n){},389:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(2),i=n.n(o),c=n(18),l=n(19),s=n(21),u=n(20),d=n(408),p=n(409),m=n(414),h=n(415),f=n(410),b=n(411),v=n(416),y=n(392),g=n(397),k=n(32);n(37);function E(e){var t,n,a={},r=[],o=Object(k.a)(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;null===i.parent_id||void 0===i.parent_id?(t=i,r.push(t)):a[i.parent_id]?a[i.parent_id].push(i):a[i.parent_id]=[i]}}catch(d){o.e(d)}finally{o.f()}for(;r.length>0;){var c=r.pop();if(c.children=[],a[c.id]){var l,s=Object(k.a)(a[c.id]);try{for(s.s();!(l=s.n()).done;){var u=l.value;c.children.push(u),r.push(u)}}catch(d){s.e(d)}finally{s.f()}}}return t.children.sort((function(e,t){return e.name-t.name})),t}var w,x,S,C,O,N,j,M,D,F,z=n(396),_=function(e,t,n){z.a[e]({message:t,description:n||null})},I=n(141),P=n(10),R=n.n(P),V=n(23),T=n(142),L=n(399),B=null,A="00000000-0000-0000-0000-000000000000",K=function(){var e=Object(V.a)(R.a.mark((function e(){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(T.b)("myDB",1,{upgrade:function(e,t,n,a){return Object(V.a)(R.a.mark((function n(){return R.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return 0===t&&(console.log("initializing DB"),e.createObjectStore("dirs",{keyPath:"id"}),e.createObjectStore("notes",{keyPath:"id"}),e.createObjectStore("contents",{keyPath:"id"})),n.abrupt("return");case 2:case"end":return n.stop()}}),n)})))()},terminated:function(){console.log("terminated")}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(V.a)(R.a.mark((function e(){var t,n,a,r,o,i,c,l,s;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("fetching menu..."),B||console.log("DB is not ready, need to connect"),e.prev=2,B){e.next=7;break}return e.next=6,K();case 6:B=e.sent;case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:return e.prev=12,e.next=15,B.get("dirs",A);case 15:if(e.sent){e.next=21;break}return t=(new Date).toISOString(),n={id:A,parent_id:null,name:"root",create_time:t,last_update:t,type:"ROOT"},e.next=21,B.put("dirs",n);case 21:return e.next=23,B.getAll("dirs");case 23:return a=e.sent,e.next=26,B.getAll("notes");case 26:r=e.sent,o=[].concat(Object(I.a)(a),Object(I.a)(r)),i={},c=Object(k.a)(o);try{for(c.s();!(l=c.n()).done;)s=l.value,i[s.id]=s}catch(u){c.e(u)}finally{c.f()}return e.abrupt("return",{nodeTable:i,rootNode:E(o)});case 34:return e.prev=34,e.t1=e.catch(12),console.log(e.t1),e.abrupt("return",Promise.reject());case 38:case"end":return e.stop()}}),e,null,[[2,9],[12,34]])})));return function(){return e.apply(this,arguments)}}(),G=function(){var e=Object(V.a)(R.a.mark((function e(t){var n,a,r,o,i,c,l;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(B){e.next=2;break}throw new Error("local DB not available");case 2:return e.prev=2,n=t.value,e.next=6,B.getAll("dirs");case 6:a=e.sent,r=Object(k.a)(a),e.prev=8,r.s();case 10:if((o=r.n()).done){e.next=16;break}if(o.value.name!==n){e.next=14;break}return e.abrupt("return",Promise.reject("name duplication"));case 14:e.next=10;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(8),r.e(e.t0);case 21:return e.prev=21,r.f(),e.finish(21);case 24:return i=Object(L.a)(),A,c=(new Date).toISOString(),"DIR",l={id:i,name:n,parent_id:"00000000-0000-0000-0000-000000000000",create_time:c,last_update:c,type:"DIR"},e.next=33,B.add("dirs",l);case 33:return e.abrupt("return","".concat(n," created"));case 36:return e.prev=36,e.t1=e.catch(2),console.log(e.t1),e.abrupt("return",Promise.reject("failed to create notebook"));case 40:case"end":return e.stop()}}),e,null,[[2,36],[8,18,21,24]])})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(V.a)(R.a.mark((function e(t,n){var a,r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B.get("dirs",t);case 3:if(a=e.sent){e.next=6;break}throw new Error("notebook does not exist");case 6:return a.name=n.value,r=(new Date).toISOString(),a.last_update=r,e.next=11,B.put("dirs",a);case 11:return e.abrupt("return","notebook updated");case 14:return e.prev=14,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",Promise.reject("update failed"));case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}(),W=function(){var e=Object(V.a)(R.a.mark((function e(t){return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B.delete("dirs",t);case 3:return e.abrupt("return","notebook deleted");case 6:return e.prev=6,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",Promise.reject("delete failed"));case 10:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(V.a)(R.a.mark((function e(t,n,a){var r,o,i,c,l,s,u,d,p,m,h,f,b,v;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=a.value,e.next=4,B.getAll("notes");case 4:o=e.sent,i=Object(k.a)(o),e.prev=6,i.s();case 8:if((c=i.n()).done){e.next=14;break}if((l=c.value).name!==r||l.parent_id!==n){e.next=12;break}return e.abrupt("return",Promise.reject("name duplication"));case 12:e.next=8;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),i.e(e.t0);case 19:return e.prev=19,i.f(),e.finish(19);case 22:return s="# ".concat(a.value," \n----\n")+t,u=Object(L.a)(),d=Object(L.a)(),p=(new Date).toISOString(),f={id:d,text:s,create_time:m=p,last_update:h=p},b={id:u,parent_id:n,content_id:d,name:r,type:"MKD",create_time:m,last_update:h},v=B.transaction(["notes","contents"],"readwrite"),e.next=33,Promise.all([v.objectStore("contents").add(f),v.objectStore("notes").add(b),v.done]);case 33:return e.abrupt("return","".concat(r," created"));case 36:return e.prev=36,e.t1=e.catch(0),console.log(e.t1),e.abrupt("return",Promise.reject("failed to create new note"));case 40:case"end":return e.stop()}}),e,null,[[0,36],[6,16,19,22]])})));return function(t,n,a){return e.apply(this,arguments)}}(),Q={getMenu:H,getContent:function(){var e=Object(V.a)(R.a.mark((function e(t){var n,a,r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B.get("notes",t);case 3:if(n=e.sent){e.next=6;break}throw new Error("note does not exist");case 6:return a=n.content_id,e.next=9,B.get("contents",a);case 9:if(r=e.sent){e.next=12;break}throw new Error("note does not exist");case 12:return e.abrupt("return",{text:r.text,title:n.name});case 15:return e.prev=15,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",Promise.reject("failed to get the content"));case 19:case"end":return e.stop()}}),e,null,[[0,15]])})));return function(t){return e.apply(this,arguments)}}(),createNote:J,createDir:G,deleteDir:W,deleteNote:function(){var e=Object(V.a)(R.a.mark((function e(t){var n,a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B.get("notes",t);case 3:return n=e.sent,a=n.content_id,e.next=7,B.delete("notes",t);case 7:return e.next=9,B.delete("contents",a);case 9:return e.abrupt("return","note deleted");case 12:return e.prev=12,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",Promise.reject("failed to delete note"));case 16:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(t){return e.apply(this,arguments)}}(),renameDir:U,renameNote:function(){var e=Object(V.a)(R.a.mark((function e(t,n){var a,r;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B.get("notes",t);case 3:if(a=e.sent){e.next=6;break}throw new Error("note does not exist");case 6:return a.name=n.value,r=(new Date).toISOString(),a.last_update=r,e.next=11,B.put("notes",a);case 11:return e.abrupt("return","note updated");case 14:return e.prev=14,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",Promise.reject("failed to update note"));case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(t,n){return e.apply(this,arguments)}}(),updateNote:function(){var e=Object(V.a)(R.a.mark((function e(t,n){var a,r,o,i;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B.get("notes",t);case 3:if(a=e.sent){e.next=6;break}throw new Error("note does not exist");case 6:return r=(new Date).toISOString(),a.last_update=r,e.next=10,B.get("contents",a.content_id);case 10:return(o=e.sent).text=n,i=B.transaction(["notes","contents"],"readwrite"),e.next=15,Promise.all([i.objectStore("contents").put(o),i.objectStore("notes").put(a),i.done]);case 15:return e.abrupt("return","note updated");case 18:return e.prev=18,e.t0=e.catch(0),console.log(e.t0),e.abrupt("return",Promise.reject("failed to update note"));case 22:case"end":return e.stop()}}),e,null,[[0,18]])})));return function(t,n){return e.apply(this,arguments)}}(),resetDB:function(){return console.log("1111"),Object(T.a)("myDB")}};w=Q.getMenu,x=Q.getContent,S=Q.createNote,C=Q.createDir,O=Q.deleteDir,N=Q.deleteNote,j=Q.renameDir,M=Q.renameNote,D=Q.updateNote,F=Q.resetDB;var Y=n(393),q=n(395),X=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).handleOk=function(){var e=a.props,t=e.callback,n=e.async,r=e.afterSuccess,o=e.maxLength,i=a.state.value;null!==i&&0!==i.trim().length?i.trim().length>o?_("error","input should be shorter than "+(o||1e3)):n?(a.setState({confirmLoading:!0}),t({value:i}).then((function(e){a.setState({confirmLoading:!1}),_("success",e),a.handleCancel(),"function"===typeof r&&r()}),(function(e){_("error",e),a.setState({confirmLoading:!1})}))):(t({value:i}),a.handleCancel(),"function"===typeof r&&r()):_("error","invalid input")},a.handleCancel=function(){(0,a.props.onCancel)()},a.onChange=function(e){a.setState({value:e.target.value})},a.state={confirmLoading:!1,value:a.props.initialValue},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this.state,t=e.confirmLoading,n=e.value,a=this.props,o=a.title,i=a.visible,c=a.placeholder;return r.a.createElement(Y.a,{title:o,visible:i,onOk:this.handleOk,confirmLoading:t,onCancel:this.handleCancel},r.a.createElement(q.a,{value:n,placeholder:c,onChange:this.onChange,onPressEnter:this.handleOk}))}}]),n}(r.a.Component);X.defaultProps={title:"",initialValue:"",placeholder:"",async:!1,afterSuccess:function(){},maxLength:1e3};var Z=X,$=n(9),ee=n(175),te=n.n(ee),ne={heading_1:"# heading",heading_2:"## heading",heading_3:"### heading",heading_4:"#### heading",ul:"- item\n- item\n- item\n",ol:"1. item\n2. item\n3. item\n",check:"\n- [x]  item\n- [ ]  item\n- [ ]  item\n",line:"\n---------------",table:"|       | col-1 | col-2 | col-3 | col-4 | col-5 |\n|-     -|-     -|-     -|-     -|-     -|-     -|\n| row-1 |       |       |       |       |       |\n| row-2 |       |       |       |       |       |\n| row-3 |       |       |       |       |       |\n",br:"<br>"},ae=n(398),re=(n(261),function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).show=function(){a.setState({visible:!0})},a.hide=function(){a.setState({visible:!1})},a.renderModal=function(){var e=a.props,t=e.title,n=e.initialValue,o=e.placeholder,i=e.callback,c=e.async,l=e.afterSuccess,s=e.maxLength,u=a.state.visible;return r.a.createElement(Z,{visible:u,title:t,initialValue:n,placeholder:o,onCancel:a.hide,callback:i,async:c,afterSuccess:l,maxLength:s,key:Math.random()})},a.state={visible:!1},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.content,t=r.a.cloneElement(e,{onClick:this.show});return r.a.createElement(r.a.Fragment,null,t,this.renderModal())}}]),n}(r.a.Component));re.defaultProps={title:"",initialValue:"",placeholder:"",async:!1,afterSuccess:function(){},maxLength:1e3};var oe=re,ie=n(401),ce=n(402),le=(n(264),n(265),n(266),{lineNumbers:!1,readOnly:!1,mode:"markdown",theme:"darcula",scrollbarStyle:"null",lineWrapping:!0}),se=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).onChange=function(e){a.props.onChange(e)},a.componentDidMount=function(){var e=a.props.initialValue;try{window.codeMirror=a.editorRef.current.getCodeMirror();var t=a.editorRef.current.getCodeMirror().getDoc();t.setValue(e),a.onChange(t.getValue())}catch(n){console.log(n)}},a.insertTextAtCursor=function(e){try{var t=a.editorRef.current.getCodeMirror().getDoc(),n=t.getCursor();t.replaceRange(e,n)}catch(r){console.log(r)}},a.handleInsert=function(e,t){var n=e.key;if("pic"===n)a.insertTextAtCursor("\n![alt text](".concat(t.value,")\n"));else if("link"===n)a.insertTextAtCursor("\n[text](".concat(t.value,")\n"));else{var r=ne[n];r&&a.insertTextAtCursor(r)}},a.headingMenu=r.a.createElement(g.a,{onClick:a.handleInsert},r.a.createElement(g.a.Item,{key:"heading_1"},"Heading level 1"),r.a.createElement(g.a.Item,{key:"heading_2"},"Heading level 2"),r.a.createElement(g.a.Item,{key:"heading_3"},"Heading level 3"),r.a.createElement(g.a.Item,{key:"heading_4"},"Heading level 4")),a.listMenu=r.a.createElement(g.a,{onClick:a.handleInsert},r.a.createElement(g.a.Item,{key:"ol"},"Ordered list"),r.a.createElement(g.a.Item,{key:"ul"},"Unordered list"),r.a.createElement(g.a.Item,{key:"check"},"Check list")),a.incFontSize=function(){a.setState({fontSize:a.state.fontSize+1})},a.resetFontSize=function(){a.setState({fontSize:16})},a.decFontSize=function(){a.setState({fontSize:a.state.fontSize-1})},a.editorRef=r.a.createRef(),a.state={fontSize:16},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.shrink,n=e.expand,a=e.exportMD,o=this.state.fontSize,i="mk-editor";return t&&(i+=" shrink"),n&&(i+=" expand"),r.a.createElement("div",{className:i,style:{fontSize:o+"px"}},r.a.createElement("div",{className:"top-bar"},r.a.createElement("span",{className:"option",onClick:function(){a()}},"Export"),r.a.createElement("span",{className:"gap"}),"Insert",r.a.createElement(ae.a,{overlay:this.headingMenu,trigger:["click"]},r.a.createElement("span",{className:"option"},"Heading")),r.a.createElement(ae.a,{overlay:this.listMenu,trigger:["click"]},r.a.createElement("span",{className:"option"},"List")),r.a.createElement(oe,{title:"Insert picture",placeholder:"Paste the picture link here",initialValue:"",callback:this.handleInsert.bind(this,{key:"pic"}),async:!1,content:r.a.createElement("span",{className:"option"},"Picture")}),r.a.createElement(oe,{title:"Insert link",placeholder:"Paste the link here",initialValue:"",callback:this.handleInsert.bind(this,{key:"link"}),async:!1,content:r.a.createElement("span",{className:"option"},"Link")}),r.a.createElement("span",{className:"option",onClick:this.handleInsert.bind(this,{key:"line"})},"Line"),r.a.createElement("span",{className:"option",onClick:this.handleInsert.bind(this,{key:"table"})},"Table"),r.a.createElement("span",{className:"option",onClick:this.handleInsert.bind(this,{key:"br"})},r.a.createElement(ie.a,null)),r.a.createElement("span",{className:"gap"}),r.a.createElement(ce.a,{style:{padding:"8px 6px 0px 0px"}}),r.a.createElement("span",{className:"option",onClick:this.incFontSize},"+"),r.a.createElement("span",{className:"option",onClick:this.resetFontSize},"Re"),r.a.createElement("span",{className:"option",onClick:this.decFontSize},"-")),r.a.createElement(te.a,{ref:this.editorRef,onChange:this.onChange,options:le}))}}]),n}(r.a.Component),ue=n(179),de=n.n(ue),pe=(n(354),function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).incFontSize=function(){a.setState({fontSize:a.state.fontSize+1})},a.resetFontSize=function(){a.setState({fontSize:16})},a.decFontSize=function(){a.setState({fontSize:a.state.fontSize-1})},a.state={fontSize:16},a}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props,t=e.shrink,n=e.expand,a=e.source,o=this.state.fontSize,i="mk-display";return t&&(i+=" shrink"),n&&(i+=" expand"),r.a.createElement("div",{className:i,style:{fontSize:o+"px"}},r.a.createElement("div",{className:"font-size"},"Font size:",r.a.createElement("span",{className:"option",onClick:this.incFontSize},"+"),r.a.createElement("span",{className:"option",onClick:this.resetFontSize},"Reset"),r.a.createElement("span",{className:"option",onClick:this.decFontSize},"-")),r.a.createElement(de.a,{source:a,escapeHtml:!1}))}}]),n}(r.a.Component)),me=n(391),he=n(394),fe=n(403),be=n(180),ve=(n(355),r.a.createElement(fe.a,{style:{fontSize:120},spin:!0})),ye=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).getNewContent=function(e){a.setState({ready:!1}),x(e).then((function(e){a.setState({source:e.text,ready:!0,changed:!1,title:e.title})}),(function(){a.props.history.push("/")}))},a.onEditorChange=function(e){a.state.source!==e&&a.setState({source:e,changed:!0})},a.sizeChange=function(e){a.setState({sizeConfig:e})},a.exportMD=function(){var e=new Blob([a.state.source],{type:"text/plain;charset=utf-8"});Object(be.saveAs)(e,a.state.title+".md")},a.state={source:"",ready:!1,changed:!1,sizeConfig:1,title:"unknown"},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.noteId;this.getNewContent(e)}},{key:"componentDidUpdate",value:function(e){var t=this.props.noteId;e.noteId!==t&&this.getNewContent(t)}},{key:"shouldComponentUpdate",value:function(e){if(e.location.pathname!==this.props.location.pathname){var t=window.codeMirror.getDoc(),n=this.props.location.pathname.slice(6),a=this.state.changed;if(!t||!n||n.length<1||!a)return!0;var r=t.getValue();D(n,r).then((function(e){_("success","Auto saving completed \n"+e)}),(function(){_("error","update failed, try again later")}))}return!0}},{key:"componentWillUnmount",value:function(){var e=window.codeMirror.getDoc(),t=this.props.location.pathname.slice(6),n=this.state.changed;if(!e||!t||t.length<1||!n)return!0;var a=e.getValue();D(t,a).then((function(e){_("success","Auto saving completed \n"+e)}),(function(){_("error","update failed, try again later")}))}},{key:"render",value:function(){var e=this.state,t=e.source,n=e.ready,a=e.sizeConfig;return r.a.createElement("div",{className:"main mk-mode"},!n&&r.a.createElement(me.a,{indicator:ve}),!!n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(se,{onChange:this.onEditorChange,exportMD:this.exportMD,initialValue:t,shrink:0===a,expand:2===a}),r.a.createElement(pe,{source:this.state.source,shrink:2===a,expand:0===a}),r.a.createElement("div",{className:"slider-bar"},r.a.createElement(he.a,{max:2,defaultValue:1,included:!1,tooltipVisible:!1,onChange:this.sizeChange,value:a}))))}}]),n}(r.a.Component),ge=Object($.h)(ye),ke=n(58),Ee=n(404),we=n(405),xe=n(406),Se=n(400),Ce=n(17),Oe=(n(382),function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,o=new Array(a),i=0;i<a;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).renderChildren=function(t,n){var a=e.props.history,o=[],i=[];t.sort((function(e,t){return(""+e.name).localeCompare(""+t.name)}));var c,l=Object(k.a)(t);try{var s=function(){var t=c.value;"DIR"===t.type?o.push(r.a.createElement("div",{className:"unit",key:t.id},r.a.createElement("div",{className:"icon-container",style:{textAlign:"center"}},r.a.createElement(Ee.a,{style:{fontSize:"50px"},className:"pointer",onClick:function(){a.push("/dir/".concat(t.id))}})),r.a.createElement("div",{className:"file-name pointer",onClick:function(){a.push("/dir/".concat(t.id))}},t.name),e.renderRenameButtonForNotebook(j.bind(Object(ke.a)(e),t.id),t.name),e.renderDeleteButtonForNotebook(e.onDirDelete.bind(Object(ke.a)(e),t.id)))):i.push(r.a.createElement("div",{className:"unit",key:t.id},r.a.createElement("div",{className:"icon-container",style:{textAlign:"center"}},r.a.createElement(we.a,{style:{fontSize:"50px"},className:"pointer",twoToneColor:"#ffd152",onClick:function(){a.push("/note/".concat(t.id))}})),r.a.createElement("div",{className:"file-name pointer",onClick:function(){a.push("/note/".concat(t.id))}},t.name),e.renderRenameButtonForNote(M.bind(Object(ke.a)(e),t.id),t.name),e.renderDeleteButtonForNote(e.onNoteDelete.bind(Object(ke.a)(e),t.id))))};for(l.s();!(c=l.n()).done;)s()}catch(d){l.e(d)}finally{l.f()}var u=[].concat(o,i);return"00000000-0000-0000-0000-000000000000"!==n&&u.unshift(r.a.createElement("div",{className:"unit",key:"return"},r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(xe.a,{className:"pointer",style:{fontSize:"50px",color:"#1790ff"},onClick:function(){a.push("/root")}})),r.a.createElement("div",{className:"file-name pointer",onClick:function(){a.push("/root")}},"Return"))),u},e.renderDeleteButtonForNotebook=function(e){return r.a.createElement(Se.a,{title:"Sure to delete this notebook?",onConfirm:e},r.a.createElement(Ce.a,{danger:!0,type:"primary",size:"small"},"Delete"))},e.renderDeleteButtonForNote=function(e){return r.a.createElement(Se.a,{title:"Sure to delete this note?",onConfirm:e},r.a.createElement(Ce.a,{danger:!0,type:"primary",size:"small"},"Delete"))},e.renderRenameButtonForNotebook=function(t,n){return r.a.createElement(oe,{title:"Rename notebook",placeholder:"Give a new name for your notebook",initialValue:n,callback:t,async:!0,afterSuccess:e.props.updateFunction,content:r.a.createElement(Ce.a,{size:"small"},"Rename")})},e.renderRenameButtonForNote=function(t,n){return r.a.createElement(oe,{title:"Rename note",placeholder:"Give a new name for your note",initialValue:n,callback:t,async:!0,afterSuccess:e.props.updateFunction,content:r.a.createElement(Ce.a,{size:"small"},"Rename"),maxLength:50})},e.onDirDelete=function(t){O(t).then((function(t){e.props.updateFunction(),_("success",t)}))},e.onNoteDelete=function(t){N(t).then((function(t){e.props.updateFunction(),_("success",t)}))},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this.props.directory,t=e.name,n=e.id,a=this.renderChildren(e.children,n);return r.a.createElement("div",{className:"dir-module"},r.a.createElement("h1",{className:"title"},t),r.a.createElement("div",{className:"fileContainer"},a))}}]),n}(r.a.Component)),Ne=Object($.h)(Oe),je=n(184),Me=(n(385),n(407)),De=n(412),Fe=n(413),ze=n(78),_e=function(){F(),console.log("data base deleted"),window.location.reload()},Ie=function(){var e=Object(a.useState)(!1),t=Object(je.a)(e,2),n=t[0],o=t[1],i=n?"cover open":"cover";return r.a.createElement("div",{className:"welcome"},r.a.createElement("h1",null,"Welcome to MD-Note"),r.a.createElement("p",null,"Create your notes with Markdown"),r.a.createElement("ul",null,r.a.createElement("li",null,"Full Markdown syntax support"),r.a.createElement("li",null,"Real time compilation and display"),r.a.createElement("li",null,"No need for account"),r.a.createElement("li",null,"Automatical saving")),r.a.createElement("br",null),r.a.createElement("h2",null,"Local Storage"),r.a.createElement("p",null,"MD-Note stores your notes locally, which means all your files are accessible offline!"),r.a.createElement("br",null),r.a.createElement("h2",null,"Reset Local Data Base"),r.a.createElement("p",null,"You can reset your local database via this button."),r.a.createElement("div",{style:{position:"relative"}},r.a.createElement("div",{className:i,onClick:function(){o(!n)}},r.a.createElement(Me.a,{style:{fontSize:"50px",color:"#FFD152"}})),r.a.createElement(Se.a,{title:"Sure to reset the database?",onConfirm:_e},r.a.createElement(Ce.a,{type:"primary",danger:!0},"RESET"))),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("h2",null,"Navigation"),r.a.createElement("p",null,"You can keep mutiple notebooks(folders), each of them can hold mutiple notes(files). Use the Menu on left side for navigation."),r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(d.a,null)," directs you to a notebook view which allows you manage everything in it."),r.a.createElement("li",null,r.a.createElement(p.a,null)," directs you to a note editor."),r.a.createElement("li",null,r.a.createElement(f.a,null)," creates a new notebook."),r.a.createElement("li",null,r.a.createElement(b.a,null)," creates a new note file in current notebook.")),r.a.createElement("p",null,"Click ",r.a.createElement(ze.b,{to:"/root"},"here")," to view your root directory."),r.a.createElement("br",null),r.a.createElement("h2",null,"About Markdown"),r.a.createElement("div",{style:{display:"flex"}},r.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"104",height:"64",viewBox:"0 0 208 128"},r.a.createElement("rect",{width:"198",height:"118",x:"5",y:"5",ry:"10",stroke:"#FFD152",strokeWidth:"10",fill:"none"}),r.a.createElement("path",{fill:"#FFD152",d:"M30 98V30h20l20 25 20-25h20v68H90V59L70 84 50 59v39zm125 0l-30-33h20V30h20v35h20z"}),r.a.createElement("script",{xmlns:""})),r.a.createElement("p",{style:{marginLeft:"20px"}},"Markdown is a lightweight markup language that you can use to add formatting elements to plaintext text documents. Created by John Gruber in 2004, Markdown is now one of the world\u2019s most popular markup languages.")),r.a.createElement("p",null,"Markdown is a fast and easy way to take notes, create content for a website, and produce print-ready documents. It doesn\u2019t take long to learn the Markdown syntax, and once you know how to use it, you can write using Markdown just about everywhere. Most people use Markdown to create content for the web, but Markdown is good for formatting everything from email messages to grocery lists."),r.a.createElement("br",null),r.a.createElement("h2",null,"About me \xa0",r.a.createElement("a",{href:"https://fuhuan1991.github.io",style:{color:"#FFD152"}},r.a.createElement(De.a,null)),"\xa0",r.a.createElement("a",{href:"https://github.com/fuhuan1991",style:{color:"#FFD152"}},r.a.createElement(Fe.a,null))),r.a.createElement("p",null,"I'm Huan Fu, a Software Engineer with 2 years of developing experience of data platform and E-commerce web applications Currently, I'm a master\u2019s student in computer science at Tufts and am very passionate in applying programing skills to create better experience for users."))},Pe=function(e){var t=e.rootDir,n=e.updateFunction;return r.a.createElement(Ne,{directory:t,updateFunction:n})},Re=function(e){var t=Object($.g)().id,n=e.nodeTable,a=e.updateFunction;return n[t]?r.a.createElement(Ne,{directory:n[t],updateFunction:a}):r.a.createElement($.a,{to:"/root"})},Ve=function(){var e=Object($.g)().id;return r.a.createElement(ge,{noteId:e})},Te=function(e){var t=e.nodeTable,n=e.rootKey,a=e.fetchMenuFromRear;return r.a.createElement($.d,null,r.a.createElement($.b,{exact:!0,path:"/"},r.a.createElement(Ie,null)),r.a.createElement($.b,{exact:!0,path:"/root"},r.a.createElement(Pe,{rootDir:t?t[n]:null,updateFunction:a})),r.a.createElement($.b,{path:"/dir/:id"},r.a.createElement(Re,{nodeTable:t,updateFunction:a})),r.a.createElement($.b,{path:"/note/:id"},r.a.createElement(Ve,null)),r.a.createElement($.b,null,r.a.createElement($.a,{to:"/"})))},Le=(n(386),y.a.Sider),Be=g.a.SubMenu,Ae=g.a.Item,Ke=function(e){Object(s.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).rootKey=null,a.fetchMenuFromRear=function(){w().then((function(e){if(e&&"object"===typeof e){var t=e.nodeTable,n=e.rootNode;console.info("fetch Menu From Rear",t,n),a.rootKey=n.id,a.setState({ready:!0,nodeTable:t,renderedMenu:a.renderMenu(n,!0)})}else _("error","failed to fetch your notebooks, please refresh")}),(function(e){_("error","failed to fetch your notebooks, please refresh")}))},a.renderMenu=function(e,t){var n=a.props.history;if(t){var o=e.children.map((function(e){return a.renderMenu(e,!1)}));return r.a.createElement(Be,{key:e.id,icon:r.a.createElement(d.a,null),title:"Notebooks",onTitleClick:function(){a.state.isSidebarCollapsed?a.moveSideMenu(!1):n.push("/root")},popupClassName:"side-bar-popup"},o)}if("MKD"===e.type)return r.a.createElement(Ae,{key:e.id,icon:r.a.createElement(p.a,null)},e.name);var i=e.children.map((function(e){return a.renderMenu(e,!1)}));return r.a.createElement(Be,{key:e.id,icon:r.a.createElement(d.a,null),title:e.name,onTitleClick:function(){n.push("/dir/".concat(e.id))}},i)},a.moveSideMenu=function(e){a.setState({isSidebarCollapsed:e})},a.setNewFolderPopupVisibility=function(e){a.setState({newFolderPopupVisible:e})},a.setNewNotePopupVisibility=function(e){a.setState({newNotePopupVisible:e})},a.onItemSelect=function(e){e.item;var t=e.key,n=(e.keyPath,e.selectedKeys,e.domEvent,a.props.history);"new_notebook"===t||"new_note"===t||"save"===t||("home"===t?n.push("/"):n.push("/note/".concat(t)))},a.saveCurrent=function(){var e=a.props.location,t=window.codeMirror.getDoc(),n=0===e.pathname.indexOf("/note/"),r=e.pathname.slice(6);if(n&&t&&r&&!(r.length<1)){var o=t.getValue();D(r,o).then((function(e){_("success",e)}),(function(){_("error","update failed, try again later")}))}},a.getOpenKeys=function(e){var t=a.state.nodeTable;if(0===e.indexOf("/root"))return[a.rootKey];if(0===e.indexOf("/dir/")){var n=e.slice(5);return[a.rootKey,n]}if(0===e.indexOf("/note/")){var r=e.slice(6),o=!!t[r]&&t[r].parent_id;return[a.rootKey,o]}return[]},a.getDirId=function(e){return"/root"===e?a.rootKey:0===e.indexOf("/dir/")?e.slice(5):null},a.state={isSidebarCollapsed:!0,nodeTable:null,renderedMenu:null,newFolderPopupVisible:!1,newNotePopupVisible:!1,openNotebooks:[],ready:!1},a}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.fetchMenuFromRear()}},{key:"render",value:function(){var e=this.state,t=e.isSidebarCollapsed,n=e.renderedMenu,a=e.ready,o=e.nodeTable,i=this.props.location,c=0===i.pathname.indexOf("/note/"),l=0===i.pathname.indexOf("/dir/")||0===i.pathname.indexOf("/root"),s=c?i.pathname.slice(6):null,u=this.getDirId(i.pathname),d=a?this.getOpenKeys(i.pathname):[];return r.a.createElement("div",{className:"App"},r.a.createElement(y.a,null,r.a.createElement(Le,{className:"side-bar",collapsible:!0,collapsed:t,onCollapse:this.moveSideMenu,width:240,trigger:r.a.createElement(m.a,{className:"forward-arrow icon-btn",style:{fontSize:"3rem"}}),reverseArrow:!0},r.a.createElement(g.a,{mode:"inline",selectable:!0,onSelect:this.onItemSelect,openKeys:d,selectedKeys:[s]},r.a.createElement(g.a.Item,{key:"home",icon:r.a.createElement(h.a,null)},"Home"),r.a.createElement(g.a.Item,{key:"new_notebook",icon:r.a.createElement(f.a,null),onClick:this.setNewFolderPopupVisibility.bind(this,!0)},"New Note Book"),!!l&&r.a.createElement(g.a.Item,{key:"new_note",icon:r.a.createElement(b.a,null),onClick:this.setNewNotePopupVisibility.bind(this,!0)},"New Note"),!!c&&r.a.createElement(g.a.Item,{key:"save",icon:r.a.createElement(v.a,null),onClick:this.saveCurrent},"Save"),n)),r.a.createElement(y.a,{className:"site-layout module-frame"},!!a&&r.a.createElement(Te,{nodeTable:o,rootKey:this.rootKey,fetchMenuFromRear:this.fetchMenuFromRear}))),r.a.createElement(Z,{visible:this.state.newFolderPopupVisible,title:"Create a new notebook.",placeholder:"Give a name for your new notebook",onCancel:this.setNewFolderPopupVisibility.bind(this,!1),callback:C,async:!0,afterSuccess:this.fetchMenuFromRear,key:Math.random(),maxLength:50}),r.a.createElement(Z,{visible:this.state.newNotePopupVisible,title:"Create a new note.",placeholder:"Give a name for your new note",onCancel:this.setNewNotePopupVisibility.bind(this,!1),callback:S.bind(this,"\n\n<----- Save Button\n\n### This is your new Markdown note\nAll the frequenly used Markdown syntax are supported. For more infor about the syntax, please check [here](https://www.markdownguide.org/basic-syntax/).\nYou can use insertion button on the top to insert Markdown code templetes or you can write whatever Markdown you like\n<br><br>\n\n### Examples\n---------------\n#### Bold&Italic:\n\n**bold** text.\n\n__bold__ text.\n\n*Italicized* text.\n\n<br>\n\n#### Lists:\n\n1. item\n2. item\n3. item\n\n- item\n- item\n- item\n\n\n- [x]  item\n- [ ]  item\n- [ ]  item\n\n<br>\n\n#### Tables\n|       | col-1 | col-2 | col-3 | col-4 | col-5 |\n|-     -|-     -|-     -|-     -|-     -|-     -|\n| row-1 |       |       |       |       |       |\n| row-2 |       |       |       |       |       |\n| row-3 |       |       |       |       |       |\n\n<br>\n\n#### Links\nThis is a link: [link](https://en.wikipedia.org/wiki/Don_Quixote)\n\nThis is also a link: https://en.wikipedia.org/wiki/Don_Quixote\n\n<br>\n\n#### Pictures\n\n![alt text](https://upload.wikimedia.org/wikipedia/commons/2/20/Don_Quijote_and_Sancho_Panza.jpg)\n",u),async:!0,afterSuccess:this.fetchMenuFromRear,key:Math.random(),maxLength:50}))}}]),n}(r.a.Component),He=Object($.h)(Ke);n(387),n(388);i.a.render(r.a.createElement(ze.a,null,r.a.createElement(He,null)),document.getElementById("root"))}},[[185,1,2]]]);
//# sourceMappingURL=main.8be8ad8b.chunk.js.map